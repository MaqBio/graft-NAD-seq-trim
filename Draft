featureCounts -T 10 -t exon -g gene_id -p -a /Data05/quanma/ref_genome/Fa/mRNA.gtf -o exon_counts.txt EV_IP_rep1_sorted.bam
featureCounts -T 10 -t transcript -g gene_id -p -a /Data05/quanma/ref_genome/Fa/mRNA.gtf -o transcript_counts.txt EV_IP_rep1_sorted.bam
awk 'NR>2 {print $1, $7}' transcript_counts.txt > transcript_reads.txt
awk 'NR>2 {print $1, $7}' exon_counts.txt > exon_reads.txt
join transcript_reads.txt exon_reads.txt | awk '{print $1, $2-$3}' > intron_reads.txt

total_reads=$(samtools view -c input.bam)
mapped_to_genes=$(awk '{sum += $2} END {print sum}' gene_counts.txt)
intergenic_reads=$((total_reads - mapped_to_genes))
